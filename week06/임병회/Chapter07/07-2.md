# 심층 신경망

## 2개의 층

<img width="629" height="391" alt="image" src="https://github.com/user-attachments/assets/0e87a2e2-8e23-4947-94b4-c3838ffe8b87" />

은닉층 - 입력층과 출력층 사이에 있는 모든 층<br>

```python
# dense
dense1 = keras.layers.Dense(100, activation='sigmoid',input_shape=(784,))
dense2 = keras.layers.Dense(10, activation='softmax')
```

##  심층 신경망 만들기

```python
model = keras.Sequential([dense1, dense2])
```

<img width="441" height="409" alt="image" src="https://github.com/user-attachments/assets/e4f93310-67d2-4f98-b91c-6e7f480a1d74" />

## 층을 추가하는 다른 방법

```python
# 층 추가 바로
model = keras.Sequential([
    keras.layers.Dense(100, activation='sigmoid', input_shape=(784,),
                       name='hidden'),
    keras.layers.Dense(10,activation='softmax',name='output')
], name='패션 MNIST 모델')
# 모델 생성 후 층 추가
model = keras.Sequential()
model.add(keras.layers.Dense(100, activation='sigmoid', input_shape=(784,)))
model.add(keras.layers.Dense(10, activation='softmax'))
model.summary()
```

## 랠루 함수

<img width="291" height="206" alt="image" src="https://github.com/user-attachments/assets/9af3bec7-ca6c-4b70-bd27-1e3fa9b7ce54" />

``` python
# Flatten 층, relu 함수로 층 만들
model = keras.Sequential()
model.add(keras.layers.Flatten(input_shape=(28,28)))
model.add(keras.layers.Dense(100, activation='relu'))
model.add(keras.layers.Dense(10, activation='softmax'))
# 훈련
(train_input, train_target), (test_input, test_target) =\
  keras.datasets.fashion_mnist.load_data()
train_scaled = train_input / 255.0
train_scaled, val_scaled, train_target, val_target = train_test_split(
    train_scaled, train_target, test_size=0.2, random_state=42
)
model.compile(loss='sparse_categorical_crossentropy', metrics=['accuracy'])
model.fit(train_scaled, train_target, epochs=5)
```

시그모이드 accuracy=0.8787, 랠루 함수 accuracy=0.8868로 성능 향상<br>

## 옵티마이저

<img width="552" height="403" alt="image" src="https://github.com/user-attachments/assets/30900b5f-5a50-469a-9d66-6b267b84fc90" />

적응적 학습률 - 최적점에 가까이 갈수록 학습률을 낮춤<br>

``` python
# 훈련 by Adam
model.keras.Sequential()
model.add(keras.layers.Flatten(input_shape=(28,28)))
model.add(keras.layers.Dense(100, activation='relu'))
model.add(keras.layers.Dense(10, activation='softmax'))
model.compile(optimizer='adam', loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])
model.fit(train_scaled, train_target,epochs=5)
```
