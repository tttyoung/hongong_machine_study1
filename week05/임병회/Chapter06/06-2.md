# k-평균

## k-평균 알고리즘 소개

작동방식<br>
1. 무작위로 k개의 클러스터 중심 정하기
2. 각 샘플에서 가장 가까운 클러스터 중심을 찾아 해당 클러스터의 샘플로 지정
3. 클러스터의 속한 샘플의 평균값으로 클러스터 중심 변경
4. 클러스터 중심이 변화가 없을때까지 2~3반복<br>

<img width="740" height="205" alt="image" src="https://github.com/user-attachments/assets/76cdf599-2485-4aa9-aa11-9a1e929012df" />

## KMeans 클래스

k-평균 알고리즘을 사이킷런에서 구현할 수 있게함<br>

```python
# KMeans
from sklearn.cluster import KMeans
km = KMeans(n_clusters=3, random_state=42)
km.fit(fruits_2d)
# 클러스터 별 이미지 출력
import matplotlib.pyplot as plt
def draw_fruits(arr, ratio=1):
  n = len(arr)
  rows = int(np.ceil(n/10))
  cols = n if rows <2 else 10
  fig, axs = plt.subplots(rows, cols,
                          figsize=(cols*ratio, rows*ratio), squeeze=False)
  
  for i in range(rows):
    for j in range(cols):
      if i*10+j < n:
        axs[i,j].imshow(arr[i*10+j],cmap='gray_r')
      axs[i,j].axis('off')
  plt.show()
# label  그리기
draw_fruits(fruits[km.labels_==0])
draw_fruits(fruits[km.labels_==1])
draw_fruits(fruits[km.labels_==2])

```

<img width="398" height="349" alt="image" src="https://github.com/user-attachments/assets/e4160cb8-18bb-421a-a658-a07a80a4e2a1" />
<img width="376" height="323" alt="image" src="https://github.com/user-attachments/assets/912fa155-2ecf-4aa5-9e1e-570f3998dc05" />
<img width="356" height="392" alt="image" src="https://github.com/user-attachments/assets/f0e03b2d-7a16-4906-be87-e2d2a98e0f97" />

->어느정도 잘 모음<br>

## 클러스터 중심

```python
# 클러스터 중심 기준 이미지 출력
draw_fruits(km.cluster_centers_.reshape(-1,100,100),ratio=3)
```

<img width="395" height="135" alt="image" src="https://github.com/user-attachments/assets/ba638c40-7c29-4c37-a5d3-c76d42ef1572" />

n_cluster를 지정했으므로 타깃 정보 이용한 것이다<br>

## 최적의 k 찾기

엘보우 방법 - 클러스터 개수를 늘려가면서 이너셔의 변화를 관찰하여 최적의 클러스터를 찾는 방법<br>

이너셔 - 클러스터 중심과 샘플 사이 거리 제곱합<br>

<img width="524" height="295" alt="image" src="https://github.com/user-attachments/assets/1fa6d357-fa05-47ad-ade4-f11561873dff" />

```python
# 이너셔 계산
inertia = []
for k in range(2,7):
  km = KMeans(n_clusters=k, random_state=42)
  km.fit(fruits_2d)
  inertia.append(km.inertia_)
plt.plot(range(2,7),inertia)
plt.xlabel('k')
plt.ylabel('inertia')
plt.show()
```

<img width="450" height="302" alt="image" src="https://github.com/user-attachments/assets/d5fdb771-53f8-45e6-a81a-ce63d247b192" />

명확치는 않지만 k=3이 기울기 변화가 있어 적절해보이는 k값이 된다<br>
