# 군집 알고리즘

## 타깃을 모르는 비지도 학습

비지도학습 - 타깃이 없을 때 사용하는 머신러닝 알고리즘<br>

```python
# 과일 사진 데이터
!wget https://bit.ly/fruits_300_data -O fruits_300.npy
# 데이터 로드
import numpy as np
import matplotlib.pyplot as plt
fruits = np.load('fruits_300.npy')
# 이미지 그리기
plt.imshow(fruits[0], cmap='gray')
plt.show()
# 반전 출력
plt.imshow(fruits[0], cmap='gray_r')
plt.show()
```

<img width="312" height="286" alt="image" src="https://github.com/user-attachments/assets/ff0285f8-55a4-4006-a02a-77182a9a5a89" />

```python
# 바나나, 파인애플 이미지 반전 출력
fig, axs = plt.subplots(1,2)
axs[0].imshow(fruits[100], cmap='gray_r')
axs[1].imshow(fruits[200], cmap='gray_r')
plt.show()
```
<img width="435" height="212" alt="image" src="https://github.com/user-attachments/assets/9e6b609d-d042-4b90-9a5b-fdcc8a6f4ea1" />

## 픽셀값 분석

```python
# 배열 2차->1차
apple = fruits[0:100].reshape(-1, 100*100)
pineapple = fruits[100:200].reshape(-1, 100*100)
banana = fruits[200:300].reshape(-1, 100*100)
```

<img width="586" height="181" alt="image" src="https://github.com/user-attachments/assets/0aa330c2-f5d3-43ab-aca5-7b5bfe263bf5" />

```python

# 샘플별 픽셀 평균값 히스토그램
plt.hist(np.mean(apple, axis=1), alpha=0.8)
plt.hist(np.mean(pineapple, axis=1), alpha=0.8)
plt.hist(np.mean(banana, axis=1), alpha=0.8)
plt.legend(['apple', 'pineapple', 'banana'])
plt.show()
```

<img width="447" height="286" alt="image" src="https://github.com/user-attachments/assets/1f56cf8e-28d8-4455-9beb-73c398601fcb" />

->사과,파인애플 구분불가<br>

```python
# 픽셀 별 평균값
fig, axs = plt.subplots(1,3,figsize=(20,5))
axs[0].bar(range(10000), np.mean(apple, axis=0))
axs[1].bar(range(10000), np.mean(pineapple, axis=0))
axs[2].bar(range(10000), np.mean(banana, axis=0))
plt.show()
```

<img width="666" height="197" alt="image" src="https://github.com/user-attachments/assets/7fcdfa97-b2a4-4164-9cc3-d45c04df2668" />

```python
# 픽셀 별 평균 이미지 출력
apple_mean = np.mean(apple, axis=0).reshape(100,100)
pineapple_mean = np.mean(pineapple, axis=0).reshape(100,100)
banana_mean = np.mean(banana, axis=0).reshape(100,100)
fig, axs = plt.subplots(1,3,figsize=(20,5))
axs[0].imshow(apple_mean, cmap='gray_r')
axs[1].imshow(pineapple_mean, cmap='gray_r')
axs[2].imshow(banana_mean, cmap='gray_r')
plt.show()
```

<img width="658" height="212" alt="image" src="https://github.com/user-attachments/assets/8e4cd940-94b4-4ee4-b8c7-29e0d04f9dde" />

위 이미지로 구분가능할까?<br>

## 평균값과 가까운 사진 고르기
# 오차평균 계산
abs_diff = np.abs(fruits - apple_mean)
abs_mean = np.mean(abs_diff, axis=(1,2))
print(abs_mean.shape)

```python
# apple과 오차가 가장 작은 샘플 100개
apple_index = np.argsort(abs_mean)[:100]
fig, axs = plt.subplots(10,10,figsize=(10,10))
for i in range(10):
  for j in range(10):
    axs[i,j].imshow(fruits[apple_index[i*10+j]], cmap='gray_r')
    axs[i,j].axis('off')
plt.show()
```

<img width="372" height="375" alt="image" src="https://github.com/user-attachments/assets/d1ba6b2a-7f6d-4784-9d69-cea6fb749833" />

군집 - 비슷한 샘플끼리 그룹으로 모으는 작업<br>
클러스터 - 군집 알고리즘에서 만든 그룹<br>
