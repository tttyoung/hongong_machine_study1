# 주성분 분석

## 차원과 차원 축소

차원 - 특성 개수<br>
차원 축소 - 데이터를 가장 잘 나타내는 일부 특성을 선택하여 데이터 크기를 줄이고 지도학습
모델의 성능을 향상시킬 수 있는 방법<br>
주성분 분석(PCA) - 대표저긴 차원 축소 알고리즘<br>

## 주성분 분석 소개

데이터에 있는 분산이 큰 방향을 찾는 것<br>

<img width="383" height="238" alt="image" src="https://github.com/user-attachments/assets/21b3f132-28f9-4b65-b937-a9405b1a1c75" />

<img width="411" height="301" alt="image" src="https://github.com/user-attachments/assets/7b779e9b-8b04-4147-a894-f778b06ca7fa" />

위 벡터가 주성분이 된다<br>

<img width="353" height="285" alt="image" src="https://github.com/user-attachments/assets/a56cf87b-ece8-4716-b3dd-8b55599b2386" />

분산과의 거리로 차원 축소 가능<br>

<img width="395" height="276" alt="image" src="https://github.com/user-attachments/assets/9bb26449-c505-42a5-be19-009855543d4b" />

첫번째 주성분에 수직+분산이 가장 큰 방향이 두번째 주성분<br>

## PCA 클래스

```python
# PCA
from sklearn.decomposition import PCA
pca = PCA(n_components = 50)
pca.fit(fruits_2d)
# 원본 주성분 50으로 축소
fruits_pca = pca.transform(fruits_2d)
```

## 원본 데이터 재구성

```python
fruits_inverse = pca.inverse_transform(fruits_pca)
print(fruits_inverse.shape)
# 복원 사진 출력
fruits_reconstruct = fruits_inverse.reshape(-1,100,100)
for start in [0,100,200]:
  draw_fruits(fruits_reconstruct[start:start+100])
  print("\n")
```

<img width="657" height="226" alt="image" src="https://github.com/user-attachments/assets/1ac3856f-ff38-40d7-bbca-507490e53974" />

## 설명된 분산

주성분이 원본 데이터의 분산을 얼마나 잘 나타내는지 기록한 값<br>

```python
# 설명된 분산
print(np.sum(pca.explained_variance_ratio_))
```

## 다른 알고리즘과 함께 사용하기

```python
# 원본 데이터 교차 검증
from sklearn.model_selection import cross_validate
scores = cross_validate(lr, fruits_2d, target)
print(np.mean(scores['test_score']))
print(np.mean(scores['fit_time']))
```

<img width="186" height="66" alt="image" src="https://github.com/user-attachments/assets/764505d7-af3d-40fe-8174-14d3b3f61ef9" />

```python
# pca 교차 검증
scores = cross_validate(lr, fruits_pca, target)
print(np.mean(scores['test_score']))
print(np.mean(scores['fit_time']))
```

<img width="186" height="56" alt="image" src="https://github.com/user-attachments/assets/1c7e6561-22b7-4cb7-b38d-f42158d68386" />

정확도 높고 훈련 시간 감소 확인<br>

```python
# 차원 축소 데이터로 k-평균 알고리즘
from sklearn.cluster import KMeans
km = KMeans(n_clusters=3, random_state=42)
km.fit(fruits_pca)
print(np.unique(km.labels_, return_counts=True))
# 이미지 출력
for label in range(0,3):
  draw_fruits(fruits[km.labels_==label])
  print("\n")
```

<img width="639" height="222" alt="image" src="https://github.com/user-attachments/assets/6f9f3408-13ee-4a47-9742-bfb2fc3b5d7d" />

어느 정도 잘 구분됨을 알 수 있음<br>

