# 합성곱 신경망의 구성 요소

## 합성곱

입력 데이터의 유용한 특성만 드러나게 하는 것<br>

<img width="366" height="292" alt="image" src="https://github.com/user-attachments/assets/ea2639af-64cb-4906-a970-546af39e29d6" />

<img width="147" height="284" alt="image" src="https://github.com/user-attachments/assets/d2159ed5-87c2-4846-aeb5-12922d76096b" />

<img width="737" height="224" alt="image" src="https://github.com/user-attachments/assets/2f0eeb67-ab6d-4b60-a462-200837f9172d" />

<img width="300" height="141" alt="image" src="https://github.com/user-attachments/assets/15d46393-2c62-446f-bc5f-37b9a65e9763" />

특성맵 - 합성곱 계산을 통해 얻은 출력<br>

2차원 구조 그대로 사용하여 이미지 처리 분야에서 뛰어난 성능을 발휘<br>

## 케라스 합성곱 층

```python
# 케라스 합성곱층
from tensorflow import keras
keras.layers.Conv2D(10,kernal_size=(3,3),activation='relu')
```

합성곱 신경망 - 1개 이상의 합성곱 층을 쓴 인공 신경망<br>

### 패딩과 스트라이드

패딩 - 입력 배열의 주위를 가상의 원소로 채우는 것<br>

<img width="270" height="243" alt="image" src="https://github.com/user-attachments/assets/05068fea-69db-4dd0-8bfb-7719d324bbbc" />

세임 패딩 - 입력 주위에 0으로 패딩하는 것<br>
밸리드 패딩 - 패딩 없이 합성곱을 하여 특성 맵을 만드는 경우<br>
패딩을 하는 이유 - 모서리값은 다른 값들과 달리 커널 도장에 한 번 찍히기 때문이다.<br>

```python
# 세임 패딩
keras.layers.Conv2D(10,kernal_size=(3,3),activation='relu',padding='same')
```

스트라이드 - 커널 도장의 이동 크기<br>

```python
# 스트라이드
keras.layers.Conv2D(10,kernal_size=(3,3),
activation='relu',padding='same',strides=1)
```

### 풀링

특성 맵의 가로세로 크기를 줄이는 역할<br>

<img width="775" height="394" alt="image" src="https://github.com/user-attachments/assets/91e53e96-c492-4564-b13a-ee41300ef1bb" />

최대 풀링 - 도장을 찍은 영역에서 가장 큰 값을 고름<br>
평균 풀링 - 도장을 찍은 영역의 평균값을 넣음<br>

```python
# 맥스풀
keras.layers.MaxPooling2D(2)
# 평균풀링
keras.layers.AveragePooling2D(2)
```

## 합성곱 신경망의 전체 구조

<img width="758" height="322" alt="image" src="https://github.com/user-attachments/assets/f4c26181-052d-4377-87f0-59baddd14f13" />

### 합성곱 by 컬러이미지

<img width="240" height="282" alt="image" src="https://github.com/user-attachments/assets/3f10479a-b29c-4e2b-b0b2-43c0d652f6ca" />

<img width="307" height="226" alt="image" src="https://github.com/user-attachments/assets/16a3db33-3c04-4bbc-bf81-595a48bdee73" />

<img width="478" height="271" alt="image" src="https://github.com/user-attachments/assets/5d18a7c9-6d3a-4ee1-ac8e-cad85b4fbd34" />

<img width="738" height="412" alt="image" src="https://github.com/user-attachments/assets/84af3332-4d54-4a5e-bee3-77924adde6cc" />

